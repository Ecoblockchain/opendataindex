{% macro popover_comparison_title(dataset, place) -%}
<strong>{{ dataset.title }}</strong> in <strong>{{ place.name }}</strong>
{%- endmacro %}


{% macro popover_comparison_content(entry, place, dataset, questions) -%}

{% if not entry %}
{{ gettext('There is no data available.') }}.
{% else %}
<ul>
    {% for question in questions %}
    {% if question.score %}
    {% set state = entry[question.id] %}
    {% if state == 'Y' %}
    {% set no = '' %}
    {% elif state == 'N' %}
    {% set no = 'not' %}
    {% else %}
    {% set no = 'unclear if it\'s ' %}
    {% endif %}
    <li>
        {% if question.id == 'exists' %}
        {% if state == 'Y' %}
        {{ gettext('Data exists') }}
        {% else %}
        {{ gettext('Data does not exist') }}
        {% endif %}
        {% elif question.id == 'digital' %}
        {{ gettext('It\'s %(no)s digital', no=no) }}
        {% elif question.id == 'public' %}
        {{ gettext('It\'s %(no)s public', no=no) }}
        {% elif question.id == 'free' %}
        {{ gettext('It\'s %(no)s free', no=no) }}
        {% elif question.id == 'online' %}
        {{ gettext('It\'s %(no)s online', no=no) }}
        {% if no == '' %}
        <a href="{{ questions['url'] }}" title="{{ gettext('%(dataset)s for %(place)s on the web', dataset=dataset.id, place=place.name) }}">
            {{ gettext('here') }}
        </a>
        {% endif %}
        {% elif question.id == 'machinereadable' %}
        {{ gettext('It\'s %(no)s machine readable', no=no) }}
        {% elif question.id == 'bulk' %}
        {{ gettext('It\'s %(no)s available in bulk', no=no) }}
        {% elif question.id == 'openlicense' %}
        {{ gettext('It\'s %(no)s only licensed', no=no) }}
        {% elif question.id == 'uptodate' %}
        {{ gettext('It\'s %(no)s up to date', no=no) }}
        {% endif %}
    </li>
    {% endif %}
    {% endfor %}
</ul>
<p>
    {% if entry and entry.details %}
    {{ entry.details|markdown }}
    {% else %}
    {{ gettext('No additional details') }}
    {% endif %}
</p>
<a href="{{ SITEURL }}/places/{{ place.id }}/datasets/{{ dataset.id }}/">
    {{ gettext('Read more') }} &raquo;
</a>
{% endif %}
{%- endmacro %}


{% macro history(page, odi, namespace) -%}

{# namespace = 'historical' or 'datasets' #}

<ul class="nav nav-pills">
    <li class="disabled"><a>{{ gettext('See this data over time:') }}</a></li>
    {% for year in odi.years %}

    {% if year == odi.current_year %}
        {% set route = page.url %}
        {% set anchor = gettext('Current') %}
    {% else %}
        {% set route = '%s/%s/%s/'|format(SITEURL, namespace, year) %}
        {% set anchor = year %}
    {% endif %}

    <li>
        <a href="{{ route }}" title="{{ anchor }}">
            {{ anchor }}
        </a>
    </li>
    {% endfor %}
</ul>
{%- endmacro %}


{% macro popover_slice_title(question) -%}
{{ question|markdown }}
{%- endmacro %}


{% macro popover_slice_content(description) -%}
{{ description|markdown }}
{%- endmacro %}
